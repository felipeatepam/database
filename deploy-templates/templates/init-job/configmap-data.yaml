apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ .Release.Name }}-seed
  namespace: 0oqfemca-rest-dev
  annotations:
    "helm.sh/hook": pre-install,pre-upgrade
    "helm.sh/hook-weight": "0"
data:
  init-db.sql: |
    -- Creación de la tabla si no existe
    CREATE TABLE IF NOT EXISTS messages (
        id SERIAL PRIMARY KEY,
        author VARCHAR(255),
        content TEXT UNIQUE,
        note TEXT
    );

    -- Inserción de datos con manejo de conflictos para evitar duplicados
    INSERT INTO messages (author, content, note) VALUES
    ('Alice Johnson', 'Welcome to our new database system!', 'Initial setup record'),
    ('Bob Smith', 'Database migration completed successfully', 'Migration note'),
    ('Carol Williams', 'Testing data persistence and reliability', 'QA test entry'),
    ('David Brown', 'Performance benchmark entry', 'Load testing'),
    ('Emma Davis', 'Security audit checkpoint', 'Security review'),
    ('Frank Miller', 'Backup and recovery test entry', 'DR test'),
    ('Grace Wilson', 'Multi-region sync verification', 'Replication test'),
    ('Henry Moore', 'API endpoint validation record', 'Integration test'),
    ('Ivy Taylor', 'Schema versioning checkpoint', 'Version control'),
    ('Jack Anderson', 'Production readiness verification', 'Go-live checkpoint')
    ON CONFLICT (content) DO NOTHING;
